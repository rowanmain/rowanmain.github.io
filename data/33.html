<!DOCTYPE html><html lang="ru"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>book</title></head><body>Возможно, вы уже заметили, что три принципа связности компонентов 

вступают в противоречие друг с другом . Принципы эквивалентности 

повторного использования (REP) и согласованного изменения (CCP) 

являются включительными: оба стремятся сделать компоненты как можно 

крупнее . Принцип повторного использования (CRP) — исключительный, 

стремящийся сделать компоненты как можно мельче . Задача хорошего 

архитектора — разрешить это противоречие .

На рис . 13 .1 изображена диаграмма противоречий1, показывающая, как три 

принципа связности влияют друг на друга . Ребра на диаграмме описывают 

цену нарушения принципа на противоположной вершине .

Архитектор, уделяющий внимание только принципам REP и CRP, обна-

ружит, что простое изменение вовлекает слишком большое количество 

компонентов . С другой стороны, архитектор, уделяющий особое внимание 

принципам CCP и REP, вынужден будет выпускать слишком много ненуж-

ных версий .

1 Спасибо Тиму Оттингеру за эту идею .

Заключение      119

REP

Объединение

для удобства

пользователей

CCP

Объединение

для удобства

сопровождения

CRP

Разделение

для устранения

лишних

выпусков

Где в этой области

должен находиться

ваш компонент?

Изменения затрагивают слишком

большое количество компонентов

Усложняется

повторное использование

Слишком много ненужных выпусков

Рис. 13.1. Диаграмма противоречий принципов связности

Хороший архитектор найдет в этом треугольнике противоречий золотую 

середину, отвечающую текущим нуждам разработчиков, а также подумает 

об изменениях, которые могут произойти в будущем . Например, на ранних 

этапах разработки проекта принцип CCP намного важнее, чем REP, удобство 

разработки важнее удобства повторного использования .

Вообще говоря, в начале разработки наибольшую важность имеет правая 

сторона треугольника, когда единственной жертвой является повторное 

использование . Но по мере развития и интеграции в другие проекты фокус 

начинает смещаться влево . То есть организация компонентов в проекте мо-

жет изменяться с течением времени . Это больше связано с тем, как проект 

разрабатывается и используется, нежели с тем, что фактически этот проект 

делает .

Заключение

В прошлом мы смотрели на связность проще, чем предполагают принципы 

эквивалентности повторного использования (REP), согласованного из-

120   Глава 13. Связность компонентов

менения (CCP) и совместного повторного использования (CRP) . Когда-то 

мы думали, что связность — это просто атрибут, что модуль выполняет 

одну и только одну функцию . Однако три принципа связности компонен-

тов описывают намного более сложное многообразие . Выбирая классы для 

включения в компоненты, нужно учитывать противодействующие силы, 

связанные с удобством повторного использования и разработки . Поиск 

баланса этих сил, исходя из потребностей приложения, — непростая задача . 

Кроме того, баланс практически всегда постоянно смещается . То есть раз-

биение, считающееся удачным сегодня, может оказаться неудачным через 

год . Как следствие, состав компонентов почти наверняка будет изменяться 

с течением времени и смещением фокуса проекта с удобства разработки 

к удобству повторного использования .

14

Сочетаемость 

компонентов

122   Глава 14. Сочетаемость компонентов

Следующие три принципа определяют правила взаимоотношений между 

компонентами . И снова мы сталкиваемся с противоречиями между удоб-

ством разработки и логической организацией . Силы, воздействующие на 

архитектуру структуры компонентов, носят технический, политический 

и непостоянный характер .

Принцип ацикличности зависимостей

Циклы в графе зависимостей компонентов недопустимы.

Бывало ли у вас так, что вы целый день проработали, заставили что-то 

заработать, а на следующее утро, придя на работу, обнаружили, что опять 

ничего не работает? Почему это произошло? Потому что кто-то задержался 

на работе дольше вас и изменил что-то, от чего зависит ваш код! Я называю 

это «синдромом следующего утра» .

«Синдром следующего утра» возникает, когда одни и те же файлы с ис-

ходным кодом правят сразу несколько разработчиков . В относительно не-

больших проектах, над которыми трудится малое количество разработчиков, 

эта проблема не доставляет особых хлопот . Но в крупных проектах с много-

численным коллективом следующее утро может превратиться в настоящий 

кошмар . Нередко проходят неделя за неделей, а команда все не в состоянии 

собрать стабильную версию проекта . Вместо этого разработчики правят 

и правят свой код, пытаясь заставить его работать с изменениями, сделан-

ными кем-то другим .

За последние десятилетия было выработано два решения этой проблемы, 

и оба пришли из телекоммуникационной отрасли . Первое: «еженедельные 

сборки» . И второе: соблюдение принципа ацикличности зависимостей 

(Acyclic Dependencies Principle; ADP) .

Еженедельные сборки

Еженедельные сборки часто используются в проектах среднего размера . 

Это решение действует так: все разработчики работают независимо первые 

четыре дня в неделе . Они изменяют собственные копии кода и не заботят-
</body></html>