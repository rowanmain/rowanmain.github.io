<!DOCTYPE html><html lang="ru"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>book</title></head><body>C

Но у нас оставалась еще проблема в виде языка ассемблера 8085, который мы 

продолжали использовать. Это было ложкой дегтя в бочке меда. Я уже слышал 

про «новый» язык, широко использовавшийся в Bell Labs. Они назвали его «C». 

Поэтому я купил книгу The C Programming Language2 Кернигана и Ритчи. Как 

и руководства для PDP-11, несколькими месяцами раньше, я проглотил эту 

книгу.

Я был поражен простотой и элегантностью этого языка. Он обладал мощностью 

языка ассемблера, но открывал доступ к этой мощности, предоставляя более 

удобный синтаксис. Я был в восторге.

Я купил компилятор C в компании Whitesmiths и запустил его на PDP-11. 

Он производил код на языке ассемблера, синтаксис которого был совместим 

с компилятором 8085 от Boston Systems Office. То есть у нас появилась возмож-

ность писать программы на C для 8085! Мы были готовы к работе.

Теперь оставалась единственная проблема — убедить программистов, пишущих 

на ассемблере, что они должны перейти на C. Но эту кошмарную историю я рас-

скажу в другой раз...

1 RKO7.

2 Последнее переиздание на русском языке: Брайн Керниган, Денис Ритчи. Язык про-

граммирования C. М.: Вильямс, 2016. — Примеч. пер.

328   Приложение. Архитектурная археология

BOSS

Наша платформа на процессоре 8085 не имела операционной системы. Мой 

опыт работы с системой MPS на ЭВМ M365 и знание простейших механизмов 

прерываний в IBM System 7 подсказывали, что нам нужен простой диспетчер 

задач для 8085. Поэтому я задумал написать BOSS: Basic Operating System and 

Scheduler (базовая операционная система с планировщиком)1.

Значительная часть BOSS была написана на C. Она могла конкурентно выпол-

нять несколько задач. Многозадачность не была вытесняющей — переключение 

происходило не по прерываниям, а так же, как в системе MPS для M365, с по-

мощью простого механизма опроса. Опрос происходил всякий раз, когда задача 

блокировалась в ожидании события.

Вызов, блокирующий задачу, выглядел в BOSS так:

block(eventCheckFunction);

Этот вызов приостанавливал текущую задачу, помещал eventCheckFunction 

в список опроса и связывал ее с только что заблокированной задачей. Затем 

выполнялся цикл опроса, в котором последовательно вызывались функции из 

списка, пока одна из них не возвращала true. Затем возобновлялось выполнение 

задачи, связанной с этой функцией.

То есть, как я говорил выше, это был простой невытесняющий диспетчер задач.

Это программное обеспечение стало основой для большого количества про-

ектов, разрабатывавшихся в следующие несколько лет. Но одним из первых 

был pCCU.

pCCU

Конец 1970-х — начало 1980-х годов было шумным временем для те лефонных 

компаний. Одной из причин волнений стала цифровая революция.

В предыдущем веке коммутационный узел и телефон клиента связывала пара 

медных проводов. Эти провода связывались в кабели, образующие разветвлен-

ную сеть по всей стране. Иногда их подвешивали на столбах, иногда проклады-

вали под землей.

Медь — дорогой металл, и телефонные компании владели тоннами, буквально 

тоннами этого металла в виде проводов, опутывающих страну. Капиталовложения 

были огромными. Большую часть этих капиталовложений можно было сэконо-

1 Позднее эта аббревиатура получила другую расшифровку: Bob’s Only Successful 

Software (успешное программное обеспечение Боба).

pCCU   329

мить передачей телефонных разговоров через цифровые соединения. Одна пара 

медных проводов могла бы переносить сотни диалогов в цифровой форме.

В ответ телефонные компании приступили к замене старого аналогового ком-

мутационного оборудования современными цифровыми коммутаторами.

Наш продукт 4-Tel тестировал медные провода, но не мог тестировать цифровые 

соединения. В цифровой среде все еще использовались медные провода, но они 

были намного короче, чем раньше, и сосредоточены в основном рядом с теле-

фонами клиентов. Сигнал от телефонной станции передавался в цифровой 

форме до местного распределительного пункта, где преобразовывался обратно 

в аналоговую форму и доставлялся до клиента по обычной паре медных про-

водов. Это означало, что наша измеряющая аппаратура должна находиться там, 

где начинаются медные провода, но устройство соединения с ним должно было 

оставаться в телефонной станции. Проблема в том, что все наши компьютеры 

COLT объединяли устройство соединения и аппаратуру измерения в одном 

корпусе. (Мы могли бы сэкономить целое состояние, узнав об этой очевидной 

архитектурной границе на несколько лет раньше!)

В результате мы задумали продукт с новой архитектурой: CCU/CMU (COLT 

control unit/COLT measurement unit — модуль управления COLT/модуль из-

мерения COLT). По задумке модуль CCU должен находиться в телефонной 

станции и обеспечивать выбор телефонных линий для тестирования. Модуль 

CMU должен находиться в местных распределительных пунктах и измерять 

уровень сигнала в медных проводах, идущих к телефону клиента.

Проблема состояла в том, что на каждый модуль CCU приходилось много мо-

дулей CMU. Информация о том, какой модуль CMU использовать для каждого 

телефонного номера, содержалась в самом цифровом коммутаторе. То есть 

модуль CCU должен был опросить цифровой коммутатор, чтобы определить, 

с каким модулем он должен взаимодействовать.

Мы пообещали телефонным компаниям, что создадим эту новую архитектуру 

к моменту их перехода. Мы знали, что это займет месяцы, если не годы, по-

этому чувствовали себя раскованно. Мы также знали, что для разработки но-

вого программно-аппаратного комплекса CCU/CMU потребуется несколько 

человеко-лет.

Ловушка планирования

С течением времени у нас постоянно всплывали какие-то неотложные во-

просы, для решения которых мы были вынуждены откладывать разработку 

архитектуры CCU/CMU. Мы были уверены в своем решении, потому что 

телефонные компании тоже все время откладывали разработку цифровых 

коммутаторов. Заглядывая в их графики, мы были уверены, что у нас еще 

масса времени, поэтому мы постоянно откладывали нашу разработку.

330   Приложение. Архитектурная археология

Но настал день, когда мой начальник вызвал меня к себе в кабинет и сказал: 

«Один из наших клиентов развертывает цифровой коммутатор в следующем 

месяце. К тому времени у нас должен быть рабочий комплекс CCU/CMU».

Я был в ужасе! Как за месяц выполнить работы, требующие одного человеко-
</body></html>