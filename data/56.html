<!DOCTYPE html><html lang="ru"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>book</title></head><body>зации архитектур . В том числе:

 

� Гексагональная архитектура (Hexagonal Architecture, также известна как 

архитектура портов и адаптеров), разработанная Алистером Кокберном 

и описанная Стивом Фриманом и Натом Прайсом в их замечательной 

книге Growing Object Oriented Software with Tests .

 

� DCI1, предложенная Джеймсом Коплиеном и Трюгве Реенскаугом .

 

� BCE2, предложенная Иваром Якобсоном в книге Object Oriented Software 

Engineering: A Use-Case Driven Approach .

Несмотря на различия в деталях, все эти архитектуры очень похожи . Они 

все преследуют одну цель — разделение задач . Они все достигают этой цели 

путем деления программного обеспечения на уровни . Каждая имеет хотя 

бы один уровень для бизнес-правил и еще один для пользовательского 

и системного интерфейсов .

Каждая из этих архитектур способствует созданию систем, обладающих 

следующими характеристиками:

 

� Независимость от фреймворков. Архитектура не зависит от наличия 

какой-либо библиотеки . Это позволяет рассматривать фреймворки как 

инструменты, вместо того чтобы стараться втиснуть систему в их рамки .

 

� Простота тестирования. Бизнес-правила можно тестировать без поль-

зовательского интерфейса, базы данных, веб-сервера и любых других 

внешних элементов .

 

� Независимость от пользовательского интерфейса . Пользовательский 

интерфейс можно легко изменять, не затрагивая остальную систему . 

Например, веб-интерфейс можно заменить консольным интерфейсом, 

не изменяя бизнес-правил .

 

� Независимость от базы данных. Вы можете поменять Oracle или SQL 

Server на Mongo, BigTable, CouchDB или что-то еще . Бизнес-правила не 

привязаны к базе данных .

 

� Независимость от любых внешних агентов. Ваши бизнес-правила ничего 

не знают об интерфейсах, ведущих во внешний мир .

Диаграмма на рис . 22 .1 — это попытка объединить все эти архитектуры 

в одну практически осуществимую идею .

1 Data-Context-Interaction — данные, контекст, взаимодействие . — Примеч. пер.

2 Boundary-Control-Entity — граница, управление, сущность . — Примеч. пер.

204   Глава 22. Чистая архитектура

Чистая архитектура

Устройства

Контроллеры

Веб

Варианты

использования

Сущности

Шлюзы

Презентаторы

Пользовательский

интерфейс

Внешние

интерфейсы

Бизнес-правила уровня

предприятия

Прикладные

бизнес-правила

Адаптеры

интерфейсов

Фреймворки

и драйверы

Презентатор

Порт вывода

варианта

использования

Средство

управления

в варианте

использования

Порт ввода

варианта

использования

Контроллер

Поток управления

Рис. 22.1. Чистая архитектура

Правило зависимостей

Концентрические круги на рис . 22 .1 представляют разные уровни про-

граммного обеспечения . Чем ближе к центру, тем выше уровень . Внешние 

круги — это механизмы . Внутренние — политики .

Главным правилом, приводящим эту архитектуру в действие, является пра-

вило зависимостей (Dependency Rule):

Зависимости в исходном коде должны быть направлены внутрь, в сторону 

высокоуровневых политик.

Ничто во внутреннем круге ничего не знает о внешних кругах . Например, 

имена, объявленные во внешних кругах, не должны упоминаться в коде, 

находящемся во внутренних кругах . Сюда относятся функции, классы, пере-

менные и любые другие именованные элементы программы .

Точно так же форматы данных, объявленные во внешних кругах, не должны 

использоваться во внутренних, особенно если эти форматы генерируются 

Правило зависимостей      205

фреймворком во внешнем круге . Ничто во внешнем круге не должно влиять 

на внутренние круги .

Сущности

Сущности заключают в себе критические бизнес-правила уровня предпри-

ятия . Сущность может быть объектом с методами или набором структур 

данных и функций . Сама организация не важна, если сущности доступны 

для использования разными приложениями на предприятии .
</body></html>