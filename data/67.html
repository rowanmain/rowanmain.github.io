<!DOCTYPE html><html lang="ru"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>book</title></head><body>тестов.

Хрупкие тесты часто оказывают отрицательное влияние, делая систему 

жесткой. Когда разработчики замечают, что простые изменения в системе 

вызывают массовые отказы тестов, они могут противиться таким изме-

нениям. Например, представьте диалог между командой разработчиков 

и сотрудниками отдела маркетинга, просящими внести простое изменение 

в структуру навигации, которое нарушит работу 1000 тестов.

Решение заключается в том, чтобы закладывать возможность тестирования 

в проект. Первое правило проектирования программного обеспечения — 

идет ли речь о тестируемости или о чем-то еще — всегда одно: не зависеть 

ни от чего, что может часто меняться. Пользовательские интерфейсы 

переменчивы. Наборы тестов, осуществляющие проверки посредством 

пользовательского интерфейса, должны быть хрупкими. Поэтому система 

и тесты должны проектироваться так, чтобы работу бизнес-правил можно 

было проверить без пользовательского интерфейса.

Безопасность      245

Программный интерфейс 

для тестирования

Для достижения этой цели следует создать специальный программный 

интерфейс для тестов, чтобы дать им возможность проверить все бизнес-

правила . Этот API должен защищать тесты от проблем с ограничениями 

безопасности, не использовать дорогостоящие ресурсы (таких, как базы дан-

ных) и заставлять систему входить в особые тестируемые состояния . Такой 

API должен быть надмножеством интеракторов и адаптеров интерфейсов, 

которые используются пользовательским интерфейсом .

Цель API тестирования — отделить тесты от приложения . Под отделением 

подра зумевается не только отделение тестов от пользовательского интер-

фейса: цель — отделить структуру тестов от структуры приложения .

Структурная зависимость

Структурная зависимость — одна из самых сильных и наиболее коварных 

форм зависимости тестов . Представьте набор тестов, в котором имеются те-

стовые классы для всех прикладных классов и тестовые методы для всех при-

кладных методов . Такой набор очень тесно связан со структурой приложения .

Изменение в одном из прикладных методов или классов может повлечь не-

обходимость изменить большое количество тестов . Следовательно, тесты 

слишком хрупкие и могут сделать прикладной код слишком жестким .

Роль API тестирования — скрыть структуру приложения от тестов . Это по-

зволит развивать прикладной код, не влияя на тесты . Это также позволит 

развивать тесты, не влияя на прикладной код .

Такая возможность независимого развития абсолютно необходима, потому 

что с течением времени тесты становятся все более конкретными, а при-

кладной код, напротив, — все более абстрактным и обобщенным . Тесная 

структурная зависимость препятствует такому развитию — или, по меньшей 

мере, затрудняет его — и мешает прикладному коду становиться все более 

обобщенным и гибким .

Безопасность

Открытость API тестирования может представлять опасность, если раз-

вернуть его в производственной системе . Если это действительно так, API 

246   Глава 28. Границы тестов

тестирования и небезопасные части его реализации должны находиться 

в отдельном компоненте, устанавливаемом независимо .

Заключение

Тесты не находятся вне системы; они — часть системы, и к их проектиро-

ванию следует подходить с неменьшим вниманием, чтобы получить от них 

выгоды в виде стабильности и защищенности от регрессий . Тесты, которые 

не проектируются как часть системы, получаются хрупкими и сложными 

в сопровождении . Такие тесты часто заканчивают свое существование в ком-

нате персонала, осуществляющего сопровождение, потому что их слишком 

тяжело поддерживать .

29

Чистая встраиваемая 

архитектура

Автор: Джеймс Греннинг  

(James Grenning)

248   Глава 29. Чистая встраиваемая архитектура

Некоторое время тому назад я прочитал статью The Growing Importance of 

Sustaining Software for the DoD1 («Растущее значение устойчивого программ-

ного обеспечения для министерства обороны») в блоге Дуга Шмидта . В ней 

Дуг сделал следующее заявление:

Несмотря на то что программное обеспечение не изнашивается, встроенные 

микропрограммы и оборудование устаревают, что требует модификации 

программного обеспечения.

Этот момент кое-что прояснил для меня . Дуг упомянул два термина, кото-

рые я мог или не мог бы счесть очевидными . Программное обеспечение — 

это то, что имеет долгий срок службы, но встроенные микропрограммы 

(firmware) устаревают в процессе развития аппаратного обеспечения . Если 

у вас есть опыт разработки встраиваемых систем, вы должны знать, что 

оборудование постоянно совершенствуется . В то же время добавляются 

новые функции в «программное обеспечение», и его сложность постоянно 

растет .

Я хотел бы добавить к заявлению Дуга:

Несмотря на то что программное обеспечение не изнашивается, оно может 

быть разрушено неуправляемыми зависимостями от микропрограмм и обо-

рудования.

Нередко встроенному программному обеспечению может быть отказано 

в долгой жизни из-за заражения зависимостями от аппаратного обеспече-

ния .

Мне нравится, как Дуг охарактеризовал микропрограммы, но давайте посмо-

трим, какие еще определения можно дать . Я, например, нашел следующие 

варианты:

 

� «Микропрограммы хранятся в энергонезависимых запоминаю-

щих устройствах, таких как ПЗУ, ППЗУ или флеш-память» (https://

ru.wikipedia.org/wiki/Встроенное_программное_обеспечение) .

 

� «Микропрограмма — это программа, или набор инструкций, заключенная 

в аппаратном устройстве» (https://techterms.com/definition/firmware) .

 

� «Микропрограмма — это программное обеспечение, встроенное в устрой-

ство» (https://www.lifewire.com/what-is-firmware-2625881) .
</body></html>