<!DOCTYPE html>
<html>
<head>
   <title>Моя статья</title>
   <link rel="stylesheet" type="text/css" href="styles.css">
</head>
<style>
body {
   background-color: #f0f0f0;
   font-family: Arial, sans-serif;
}

header {
   background-color: #333;
   color: white;
   padding: 10px;
   text-align: center;
}

h1 {
   margin: 0;
}

article {
   margin: 20px;
}

h2 {
   color: #333;
}

p {
   line-height: 1.6;
}
</style>
<body>
   <header>
       <h1>статья</h1>
   </header>
   <article>
       <p>
работали замечательно . Могли ли мы знать, что это была ошибка?

Но с большими колодами перфокарт было трудно управляться . Карты могли 

теряться, мяться, рваться, перемешиваться или проскакивать мимо . Могли 

теряться отдельные карты или добавляться лишние . То есть целостность 

данных была большой проблемой .

Магнитные ленты решили эту проблему . Мы получили возможность пере-

носить образы карт на ленту . После сброса данных на ленту записи уже не 

могли перемешаться . Они не могли потеряться по неосторожности, а также 

не могли добавиться новые пустые записи . Лента оказалась гораздо надеж-

нее . А кроме того, операции чтения/записи с лентой выполнялись намного 

быстрее, и намного проще стало делать резервные копии .

К сожалению, все наше программное обеспечение было написано для работы 

с устройствами чтения перфокарт и с перфораторами . Эти программы при-

шлось переписывать, чтобы они могли работать с магнитной лентой . Это 

была большая работа .

К концу 1960-х годов мы выучили урок и придумали, как обрести неза-

висимость от устройств . Операционные системы, современные в те дни, 

абстрагировали устройства ввода/вывода за фасадами программных функ-

ций, которые обрабатывали отдельные записи, выглядящие как перфокарты . 

Программы должны были обращаться к службам операционной системы, 

представляющим абстрактные устройства хранения единичных записей . 

Операторы могли сообщить операционной системе, к каким физическим 

устройствам должны подключаться эти абстрактные службы — устройствам 

чтения перфокарт, накопителям на магнитной ленте или любым другим 

устройствам хранения записей .

152   Глава 15. Что такое архитектура

Теперь одна и та же программа могла читать и записывать данные на пер-

фокарты или магнитные ленты без всяких изменений . Так родился принцип 

открытости/закрытости (Open-Closed Principle; OCP), но в те дни он еще 

не имел названия .

Нежелательная почта

В конце 1960-х годов я работал в компании, которая печатала рекламные 

письма для своих клиентов . Клиенты присылали магнитные ленты с запися-

ми, содержащими имена и адреса своих клиентов, а мы должны были писать 

программы, печатающие персонализированные рекламные объявления .

Примерно такого содержания:

Здравствуйте, мистер Мартин,

Поздравляем!

Мы выбрали ВАС из всех живущих на Вичвуд-лейн, чтобы сделать 

фантастическое предложение…

Клиенты присылали нам огромные рулоны с заготовками писем, куда мы 

должны были впечатать имена и адреса или любой другой текст, которые 

передавались на магнитной ленте . Мы писали программы, читающие эти 

имена, адреса и другой текст с магнитной ленты и печатающие их точно 

в отведенных полях .

Такие рулоны весили по 500 фунтов и содержали тысячи писем . Клиенты 

могли присылать сотни рулонов, и каждый приходилось печатать отдельно .

Сначала у нас была машина IBM 360, печатающая на единственном после-

довательном принтере . За смену мы могли напечатать несколько тысяч пи-

сем . К сожалению, печать таких писем стоила очень дорого . В те дни аренда 

IBM 360 обходилась в десятки тысяч долларов в месяц .

Поэтому мы настраивали операционную систему так, чтобы вместо принте-

ра она использовала магнитную ленту . Это никак не сказывалось на наших 

программах, потому что они выводили данные, используя абстракции ввода/

вывода операционной системы .

360-я могла заполнить ленту за десять минут или что-то около того — вполне 

достаточно, чтобы напечатать несколько рулонов писем . Эти ленты затем 

выносились из машинного зала и монтировались в приводы, подключенные 

Физическая адресация      153

к автономным принтерам . У нас их было пять штук, и эти пять принтеров 

работали круглые сутки без перерывов и выходных, печатая сотни тысяч 

рекламных писем каждую неделю .

Ценность независимости от устройства оказалась огромной! Мы могли 

писать программы, не зная и не заботясь о том, какие устройства будут ис-

пользоваться, и отлаживать их, используя локальный принтер, подключен-

ный к компьютеру . После этого мы могли просто приказать операционной 

системе выполнить «печать» на магнитную ленту и получить сотни тысяч 

готовых форм .

Наши программы обрели форму . Эта форма отделила политику от деталей . 

Политика заключалась в форматировании записей с именами и адресами . 

А деталями стали устройства . Мы смогли отложить принятие решения 

о выборе устройства .

Физическая адресация

В начале 1970-х годов я работал над большой системой учета для местного 

профсоюза водителей грузовиков . У нас имелся диск емкостью 25 Мбайт, 

на котором хранились записи с информацией об агентах, работодателях 

и членах профсоюза . Разные записи имели разные размеры, поэтому пер-

вые несколько цилиндров на диске форматировались так, чтобы размер 

одного сектора в точности соответствовал размеру записи с информацией 

об агенте . Следующие несколько цилиндров форматировались под записи 

с информацией о работодателях . И последние несколько цилиндров — под 

записи с информацией о членах профсоюза .

Мы писали программы, детально зная структуру диска . Мы знали, что на дис-

ке имеется 200 цилиндров и 10 головок, что каждый цилиндр имеет несколько 

десятков секторов на головку . Мы знали, какие цилиндры отводятся для 

хранения записей того или иного вида . И все это жестко «зашивалось» в код .

Мы также хранили на диске оглавление, позволявшее отыскать каждого 

агента, работодателя и члена профсоюза . Это оглавление хранилось в еще 

одной, специально отформатированной группе цилиндров . Оглавление для 

поиска агентов состояло из записей, включавших идентификационный но-

мер агента, номер цилиндра, номер головки и номер сектора, где хранится 

запись с информацией об агенте . Для поиска работодателей и членов име-

лись аналогичные оглавления . Кроме того, информация о членах профсоюза 

хранилась на диске в форме двусвязного списка: каждая запись хранила 

номер цилиндра, головки и сектора следующей и предыдущей записи .

154   Глава 15. Что такое архитектура

Представляете, во что выливался переход на использование нового диско-

вого устройства, в котором на одну головку или на один цилиндр больше? 

Мы писали специальную программу, которая читала данные в старом фор-

мате со старого диска и записывала их на новый диск, преобразуя номера 

</p>
   </article>
</body>
</html>
