<!DOCTYPE html>
<html>
<head>
   <title>Моя статья</title>
   <link rel="stylesheet" type="text/css" href="styles.css">
</head>
<style>
body {
   background-color: #f0f0f0;
   font-family: Arial, sans-serif;
}

header {
   background-color: #333;
   color: white;
   padding: 10px;
   text-align: center;
}

h1 {
   margin: 0;
}

article {
   margin: 20px;
}

h2 {
   color: #333;
}

p {
   line-height: 1.6;
}
</style>
<body>
   <header>
       <h1>статья</h1>
   </header>
   <article>
       <p>
компонента, а отсутствие компонентов, от которых он зависит, означает 

отсутствие сил, которые могли бы заставить его измениться.

Принцип устойчивых зависимостей (SDP) говорит, что метрика I компо-

нента должна быть больше метрик I компонентов, от которых он зависит. 

То есть метрики I должны уменьшаться в направлении зависимости.

Не все компоненты должны быть 

устойчивыми

Если все компоненты в системе будут иметь максимальную устойчивость, 

такую систему невозможно будет изменить. Это нежелательная ситуация. 

В действительности структура компонентов должна проектироваться так, 

чтобы в ней имелись и устойчивые, и неустойчивые компоненты. Диаграм-

ма на рис. 14.8 демонстрирует идеальную организацию системы с тремя 

компонентами.

Изменяемые компоненты находятся вверху и зависят от устойчивого ком-

понента внизу. Размещение неустойчивых компонентов в верхней части 

диаграммы — общепринятое и очень удобное соглашение, потому что любые 

стрелки, направленные вверх, ясно покажут нарушение принципа устой-

чивых зависимостей (и, как вы убедитесь далее, принципа ацикличности 

зависимостей).

неустойчивый

устойчивый

неустойчивый

Рис. 14.8. Идеальная организация системы с тремя компонентами

Диаграмма на рис. 14.9 демонстрирует нарушение принципа SDP.

Компонент Flexible специально проектировался так, чтобы его было лег-

ко изменять. Предполагалось, что он будет неустойчивым. Но кто-то из 

разработчиков, работающих над компонентом Stable, создал зависимость 

от компонента Flexible. Это явное нарушение принципа SDP, потому что 

134   Глава 14. Сочетаемость компонентов

неустойчивый

неустойчивый

устойчивый

Рис. 14.9. Нарушение принципа SDP

метрика I компонента Stable намного меньше метрики I компонента 

Flexible . Как результат, создание такой зависимости усложнило возмож-

ное изменение компонента Flexible . Теперь любые изменения в компоненте 

Flexible придется согласовывать с компонентом Stable и всеми компонен-

тами, зависящими от него .

Чтобы исправить проблему, нужно разорвать зависимость Stable от Flexible . 

Зачем нужна эта зависимость? Допустим, что в компоненте Flexible име-

ется класс C, который используется другим классом U из компонента Stable 

(рис . 14 .10) .

Рис. 14.10. Класс U в компоненте Stable использует класс C  

в компоненте Flexible

Исправить ситуацию можно, применив принцип инверсии зависимостей 

(DIP) . Для этого определим интерфейс US и поместим его в компонент 

с именем UServer . Этот интерфейс должен объявлять все методы, исполь-

зуемые классом U . Затем реализуем этот интерфейс в классе C, как показано 

на рис . 14 .11 . Это разорвет зависимость Stable от Flexible и вынудит оба 

компонента зависеть от UServer . UServer очень устойчив (I = 0), а Flexible 

сохранит желаемую неустойчивость (I = 1) . Теперь все зависимости про-

стираются в сторону уменьшения I .

Принцип устойчивости абстракций      135

Рис. 14.11. Класс C реализует интерфейс US

Абстрактные компоненты

Кому-то может показаться странным, что мы создали компонент — в дан-

ном примере UService, — не содержащий ничего, кроме интерфейса . То 

есть компонент не содержит выполняемого кода! Однако, как оказывается, 

это весьма распространенная и единственно возможная тактика в языках 

со статической системой типов, таких как Java и C# . Такие абстрактные 

компоненты очень устойчивы и поэтому служат идеальной целью для за-

висимостей в менее устойчивых компонентах .

В языках с динамической системой типов, таких как Ruby или Python, по-

добные абстрактные компоненты вообще отсутствуют, так же как зависи-

мости, которые можно было бы нацелить на них . Структура зависимостей 

в этих языках намного проще, потому что для инверсии зависимостей не 

требуется объявлять или наследовать интерфейсы .

Принцип устойчивости абстракций

Устойчивость компонента пропорциональна его абстрактности.

Куда поместить высокоуровневые правила?

Некоторые части программных систем должны меняться очень редко . Эти 

части представляют высокоуровневые архитектурные и другие важные ре-

шения . Никто не желает, чтобы такие решения были изменчивыми . Поэтому 

программное обеспечение, инкапсулирующее высокоуровневые правила, 

должно находиться в устойчивых компонентах (I = 0) . Неустойчивые (I = 1) 

должны содержать только изменчивый код — код, который можно было бы 

легко и быстро изменить .

136   Глава 14. Сочетаемость компонентов

Но если высокоуровневые правила поместить в устойчивые компонен-

ты, это усложнит изменение исходного кода, реализующего их . Это мо-

жет сделать всю архитектуру негибкой . Как компонент с максимальной 

устойчивостью (I = 0) сделать гибким настолько, чтобы он сохранял 

устойчивость при изменениях? Ответ заключается в соблюдении прин-

ципа открытости/закрытости (OCP) . Этот принцип говорит, что можно 

и нужно создавать классы, достаточно гибкие, чтобы их можно было на-

следовать (расширять) без изменения . Какие классы соответствуют этому 

принципу? Абстрактные .

Введение в принцип устойчивости абстракций

Принцип устойчивости абстракций (Stable Abstractions Principle; SAP) уста-

навливает связь между устойчивостью и абстрактностью . С одной стороны, 

он говорит, что устойчивый компонент также должен быть абстрактным, 

чтобы его устойчивость не препятствовала расширению, с другой — он го-

ворит, что неустойчивый компонент должен быть конкретным, потому что 

неустойчивость позволяет легко изменять его код .

То есть стабильный компонент должен состоять из интерфейсов и абстракт-

ных классов, чтобы его легко было расширять . Устойчивые компоненты, 

доступные для расширения, обладают достаточной гибкостью, чтобы не 

накладывать чрезмерные ограничения на архитектуру .

Принципы устойчивости абстракций (SAP) и устойчивых зависимостей 

(SDP) вместе соответствуют принципу инверсии зависимостей (DIP) для 

</p>
   </article>
</body>
</html>
