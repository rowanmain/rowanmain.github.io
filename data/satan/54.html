<!DOCTYPE html>
<html>
<head>
   <title>Моя статья</title>
   <link rel="stylesheet" type="text/css" href="styles.css">
</head>
<style>
body {
   background-color: #f0f0f0;
   font-family: Arial, sans-serif;
}

header {
   background-color: #333;
   color: white;
   padding: 10px;
   text-align: center;
}

h1 {
   margin: 0;
}

article {
   margin: 20px;
}

h2 {
   color: #333;
}

p {
   line-height: 1.6;
}
</style>
<body>
   <header>
       <h1>статья</h1>
   </header>
   <article>
       <p>
Клиент, содержащую критические бизнес-правила, регулирующие отноше-

ния между банком и клиентами .

Порядок сбора информации 

для оформления кредита

Ввод: имя, адрес, дата рождения, водительские 

права, номер карты социального страхования и пр.

Вывод: Некоторая информация для обратной связи 

+ кредитный балл.

Порядок действий:

1. Принять и проверить имя.

2. Проверить адрес, дату рождения, водительские 

права, номер карты социального страхования и пр.

3. Узнать кредитный балл.

4. Если балл < 500, отклонить заявку на кредит

5. Иначе создать Клиента и активировать 

график погашения

Рис. 20.2. Пример варианта использования

Варианты использования определяют, как и когда вызываются критические 

бизнес-правила в сущности . Варианты использования управляют действи-

ями сущности .

Отмечу также, что варианты использования не описывают пользователь-

ский интерфейс, они лишь неформально определяют входные и выходные 

данные, поступающие и возвращаемые через интерфейс . По вариантам 

использования нельзя определить, является ли данная система веб-при-

1 Это название тоже было предложено Иваром Якобсоном в той же книге .

Модели запросов и ответов      195

ложением, толстым клиентом, утилитой командной строки или чистой 

службой .

Это очень важно . Варианты использования не описывают, как выглядит си-

стема для пользователя . Они описывают только конкретные правила работы 

приложения, определяющие порядок взаимодействий между пользователя-

ми и сущностями . Для вариантов использования абсолютно неважно, как 

система осуществляет ввод/вывод данных .

Вариант использования — это объект . Он имеет одну или несколько функ-

ций, реализующих конкретные прикладные бизнес-правила . Он также имеет 

элементы данных, включая входные данные, выходные данные и ссылки на 

соответствующие сущности, с которыми он взаимодействует .

Сущности не знают ничего о вариантах использования, контролирующих их . 

Это еще один пример ориентации зависимостей в соответствии с принципом 

инверсии зависимостей (Dependency Inversion Principle) . Высокоуровневые 

элементы, такие как сущности, ничего не знают о низкоуровневых элемен-

тах, таких как варианты использования . Напротив, низкоуровневые вари-

анты использования знают все о высокоуровневых сущностях .

Почему сущности относятся к высокому уровню, а варианты использования 

к низкому? Потому что варианты использования характерны для един-

ственного приложения и, соответственно, ближе к вводу и выводу системы . 

Сущности — это обобщения, которые можно использовать в множестве раз-

ных приложений, соответственно, они дальше от ввода и вывода системы . 

Варианты использования зависят от сущностей; сущности не зависят от 

вариантов использования .

Модели запросов и ответов

Варианты использования принимают входные данные и возвращают резуль-

тат . Однако в правильно сформированном объекте варианта использования 

ничто не должно говорить о способах передачи данных пользователю или 

другим компонентам . И тем более код в классе, реализующем вариант ис-

пользования, ничего не должен знать об HTML или SQL!

Класс варианта использования принимает простые структуры данных на 

входе и возвращает простые структуры данных на выходе . Эти структуры 

данных ни от чего не зависят . Они не связаны со стандартными интерфейса-

ми фреймворков, такими как HttpRequest и HttpResponse . Они ничего не зна-

ют о Веб и не используют никакие атрибуты пользовательского интерфейса .

196   Глава 20. Бизнес-правила

Такое отсутствие зависимостей имеет решающее значение . Если модели за-

просов и ответов зависят от чего-то, варианты использования, зависящие от 

них, оказываются косвенно связанными с зависимостями, которые вносят 

эти модели .

У вас может возникнуть соблазн включить в эти структуры ссылки на объ-

екты сущностей . На первый взгляд кажется, что в этом есть определенный 

смысл, потому что сущности и модели запросов/ответов совместно ис-

пользуют так много данных . Боритесь с этим искушением! Эти два объекта 

имеют слишком разные цели . Со временем они будут меняться по разным 

причинам, поэтому создание связи между ними нарушит принципы со-

гласованного изменения (CCP) и единственной ответственности (SRP) . 

В результате у вас появится множество кочующих данных и масса условных 

инструкций в коде .

Заключение

Бизнес-правила являются причиной существования программной системы . 

Они составляют основу функционирования . Они порождают код, который 

делает или экономит деньги . Они — наши семейные реликвии .

Бизнес-правила должны оставаться в неприкосновенности, незапятнанными 

низкоуровневыми аспектами, такими как пользовательский интерфейс или 

база данных . В идеале код, представляющий бизнес-правила, должен быть 

сердцем системы, а другие задачи — просто подключаться к ним . Реализация 

бизнес-правил должна быть самым независимым кодом в системе, готовым 

к многократному использованию .

21

Кричащая 

архитектура

198   Глава 21. Кричащая архитектура

Представьте, что перед вами чертежи здания . Они подготовлены архитекто-

ром и представляют собой планы здания . О чем они вам говорят?

Если это чертежи коттеджа, вы наверняка увидите на них парадный вход, 

вестибюль, ведущий в гостиную и, может быть, в столовую . Рядом со столо-

вой, скорее всего, будет расположена кухня . Рядом с кухней, вероятно, будет 

малая столовая и где-то поблизости — общая комната . При рассмотрении 

этих планов у вас не возникнет сомнений, что вы видите коттедж для одной 

семьи . Архитектура как бы кричит: «Это коттедж» .

А теперь представьте, что вы рассматриваете архитектуру библиотеки . Вы 

наверняка увидите центральный вход, места для размещения библиотека-

рей, читальные залы, небольшие конференц-залы и галереи для хранения 

</p>
   </article>
</body>
</html>
