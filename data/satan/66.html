<!DOCTYPE html>
<html>
<head>
   <title>Моя статья</title>
   <link rel="stylesheet" type="text/css" href="styles.css">
</head>
<style>
body {
   background-color: #f0f0f0;
   font-family: Arial, sans-serif;
}

header {
   background-color: #333;
   color: white;
   padding: 10px;
   text-align: center;
}

h1 {
   margin: 0;
}

article {
   margin: 20px;
}

h2 {
   color: #333;
}

p {
   line-height: 1.6;
}
</style>
<body>
   <header>
       <h1>статья</h1>
   </header>
   <article>
       <p>
ветствии с принципами SOLID и данной структурой компонентов, чтобы 

иметь возможность добавлять в них новые компоненты, не изменяя су-

ществующие .

Представьте службу на Java как набор абстрактных классов в одном или 

нескольких jar-файлах . Каждую новую возможность или расширение су-

ществующей возможности можно реализовать как отдельный jar-файл, 

содержащий классы, наследующие абстрактные классы из уже имеющихся 

jar-файлов . Для развертывания новой возможности в этом случае больше 

не потребуется повторно развертывать службы, достаточно лишь добавить 

новые jar-файлы в пути загрузки этих служб . Иными словами, добавление 

новой возможности выполняется в соответствии с принципом открытости/

закрытости (Open-Closed Principle; OCP) .

Схема на рис . 27 .3 демонстрирует такую организацию служб . На ней пред-

ставлены все те же службы, только на этот раз каждая состоит из ком-

понентов, что позволяет добавлять новые возможности, реализованные 

240   Глава 27. Службы: большие и малые

в виде новых производных классов . Эти производные классы находятся 

в собственных компонентах .

Список кандидатов

Рис. 27.3. Каждая служба состоит из компонентов, что позволяет добавлять новые 

возможности, реализованные в виде новых производных классов

Сквозные задачи

Теперь мы знаем, что архитектурные границы не всегда совпадают с грани-

цами между службами . Часто эти границы проходят через службы, деля их 

на компоненты .

Для преодоления проблем, связанных со сквозными задачами, с которыми 

сталкиваются все достаточно крупные системы, службы должны иметь ком-

понентные архитектуры, следующие правилу зависимостей, как показано 

на рис . 27 .4 . Эти службы не определяют архитектурные границы в системе; 

границы определяются компонентами в службах .

Заключение      241

Рис. 27.4. Службы должны иметь компонентные архитектуры,  

следующие правилу зависимостей

Заключение

Несмотря на все преимущества масштабируемости и удобства разработки 

системы, службы не являются архитектурно значимыми элементами . Ар-

хитектура системы определяется границами, проводимыми внутри этой 

системы, и зависимостями, пересекающими эти границы . Архитектура не 

определяется физическими механизмами, посредством которых элементы 

взаимодействуют и выполняются .

Служба может быть единственным компонентом, полностью окруженным 

архитектурной границей . Но точно так же служба может состоять из не-

скольких компонентов, разделенных архитектурными границами . В редких1 

случаях клиенты и службы могут быть настолько связаны, что не могут 

иметь архитектурной значимости .

1 Хотелось бы надеяться, что в очень редких, но опыт показывает, что это не так .

28 Границы тестов

Тесты как компоненты системы      243

Да, все правильно: тесты являются частью системы и занимают свое место 

в архитектуре, как любые другие части системы . В одних случаях это вполне 

нормальное явление . В других оно может быть уникальным .

Тесты как компоненты системы

С тестами связано много неясностей . Являются ли они частью системы? 

Должны ли они отделяться от системы? Какие виды тестов бывают? Яв-

ляются ли модульные и интеграционные тесты разными тестами? Какое 

место во всем этом занимают приемочные тесты, функциональные тесты, 

тесты для фреймворка Cucumber, тесты TDD, тесты BDD, тесты для ком-

понентов и т . д .?

Обсуждение данной конкретной темы не является целью этой книги, 

и, к счастью, этого не требуется . С архитектурной точки зрения все тесты 

одинаковы . Будь то маленькие тесты TDD, или большие тесты FitNesse, 

Cucumber, SpecFlow, или JBehave — все они архитектурно эквивалентны .

Тесты по самой своей природе следуют правилу зависимостей; они очень де-

тальны и конкретны; и они всегда зависят от тестируемого кода . Фактически 

тесты можно считать самым внешним кругом архитектуры . Ничто в системе 

не зависит от тестов, но тесты всегда зависят от внутренних компонентов 

системы .

Тесты также можно развертывать независимо . Фактически в большинстве 

случаев они развертываются в тестовых системах, но не развертываются 

в производственных системах . То есть даже в системах, где независи-

мое развертывание не требуется, тесты все равно развертываются неза-

висимо .

Тесты являются наиболее изолированными компонентами системы . Они 

не нужны системе для нормального функционирования . Пользователи не 

зависят от них . Их роль — поддержать разработку, но не работу . И все же 

они являются не менее важным системным компонентом, чем любые дру-

гие . Фактически они представляют модель, которой должны следовать все 

остальные компоненты .

244   Глава 28. Границы тестов

Проектирование для простоты 

тестирования

Крайняя степень изоляции тестов в сочетании с тем фактом, что они 

обычно не развертываются, часто заставляет разработчиков думать, что 

тесты выходят за рамки дизайна системы. Это абсолютно неверная точка 

зрения. Тесты, недостаточно хорошо интегрированные в дизайн системы, 

обычно оказываются хрупкими и делают систему жесткой и неудобной 

для изменения.

Проблема, конечно, заключается в тесной зависимости. Тесты, тесно связан-

ные с системой, должны изменяться вместе с системой. Даже самые безо-

бидные изменения в системном компоненте могут нарушить нормальную 

работу многих связанных тестов или потребовать их изменения.

Эта ситуация может приобретать особую остроту. Изменения в общих си-

стемных компонентах могут нарушить работу сотен и даже тысяч тестов. 

Эта ситуация известна как «проблема хрупких тестов».

Нетрудно понять, как это может произойти. Представьте, например, на-

бор тестов, использующих графический интерфейс для проверки биз-

нес-правил. Такие тесты могут начинать работу на странице авторизации 

и затем последовательно переходить от страницы к странице, проверяя 

определенные бизнес-правила. Любое изменение в странице авторизации 

или в структуре навигации может нарушить работу большого количества 

</p>
   </article>
</body>
</html>
