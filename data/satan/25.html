<!DOCTYPE html>
<html>
<head>
   <title>Моя статья</title>
   <link rel="stylesheet" type="text/css" href="styles.css">
</head>
<style>
body {
   background-color: #f0f0f0;
   font-family: Arial, sans-serif;
}

header {
   background-color: #333;
   color: white;
   padding: 10px;
   text-align: center;
}

h1 {
   margin: 0;
}

article {
   margin: 20px;
}

h2 {
   color: #333;
}

p {
   line-height: 1.6;
}
</style>
<body>
   <header>
       <h1>статья</h1>
   </header>
   <article>
       <p>
презентатор

Модель

экранного

представления

Экранное

представление

Веб-представ-

ление

Веб-представ-

ление

PDF-представ-

ление

PDF-представ-

ление

Печатное

представление

Модель

печатного

представления

Печатный

презентатор

Печатный

презентатор

Рис. 8.2. Выделение процессов в классы и выделение классов в компоненты

Также важно отметить, что каждая двойная линия пересекается толь-

ко в одном направлении . Это означает, что все отношения компонентов 

однонаправленны, как показано на графе компонентов (рис . 8 .3) . Эти 

стрелки указывают на компоненты, которые мы стремимся защитить от 

изменения .

Позволю себе повторить еще раз: если компонент A требуется защитить от 

изменений в компоненте B, компонент B должен зависеть от компонента A .

Нам нужно защитить контроллер от изменений в презентаторах . Нам 

нужно защитить презентаторы от изменений в представлениях . Нам нужно 

защитить интерактор от изменений в . . . во всех остальных компонентах .

Интерактор находится в позиции, лучше соответствующей принципу 

 открытости/закрытости . Изменения в базе данных, или в контроллере, 

или в презентаторах, или в представлениях не должны влиять на ин-

терактор .

Мысленный эксперимент      89

Контроллер

финансового

отчета

Интерактор

финансового

отчета

Экранный

презентатор

Печатный

презентатор

Веб-представ-

ление

PDF-представ-

ление

Финансовая

база данных

Рис. 8.3. Отношения компонентов однонаправленны

Почему интерактор должен придерживаться такой привилегированной 

позиции? Потому что он реализует бизнес-правила . Интерактор реализует 

политики высшего уровня в приложении . Все другие компоненты решают 

второстепенные задачи . Интерактор решает самую главную задачу .

Несмотря на то что контроллер является не таким важным компонентом, как 

интерактор, он важнее презентаторов и представлений . А презентаторы, 

хотя и менее важные, чем контроллеры, в свою очередь, важнее представлений .

Обратите внимание, что в результате выстраивается иерархия защиты, 

основанная на понятии «уровня» . Интеракторы занимают самый верхний 

уровень, поэтому они должны быть самыми защищенными . Представления 

занимают самый низкий уровень, поэтому они наименее защищены . Пре-

зентаторы находятся уровнем выше представлений, но ниже контроллера 

или интерактора .

Именно так работает принцип открытости/закрытости на архитектурном 

уровне . Архитекторы разделяют функциональные возможности, опираясь 

на то, как, почему и когда их может потребоваться изменить, и затем орга-

низуют их в иерархию компонентов . Компоненты, находящиеся на верхних 

уровнях в такой иерархии, защищаются от изменений в компонентах на 

нижних уровнях .

90   Глава 8. Принцип открытости/закрытости

Управление направлением

Если вы испытали шок от схемы классов, представленной выше, взгляните 

на нее еще раз . Основная сложность в ней заключается в необходимости 

сориентировать зависимости между компонентами в правильных направ-

лениях .

Например, интерфейс шлюза финансовых данных между генератором 

финансового отчета и диспетчером финансовых данных добавлен с целью 

обратить направление зависимости, которая иначе была бы направлена 

из компонента интерактора в компонент базы данных . То же относится 

к интерфейсу презентатора финансового отчета и двум интерфейсам пред-

ставлений .

Сокрытие информации

Интерфейс заказчика финансового отчета служит другой цели — защитить 

контроллер финансового отчета от необходимости знать внутренние особен-

ности интерактора . В отсутствие этого интерфейса контроллер получил бы 

транзитивные зависимости от финансовых сущностей .

Транзитивные (переходящие) зависимости нарушают общий принцип, со-

гласно которому программные сущности не должны зависеть от того, что 

они не используют непосредственно . Мы вновь встретимся с этим принци-

пом, когда будем обсуждать принципы разделения интерфейсов и совмест-

ного повторного использования (Common Reuse Principle; CRP) .

Поэтому, даже при том, что высший приоритет имеет защита интерактора 

от изменений в контроллере, мы также должны защитить контроллер от из-

менений в интеракторе, скрыв детали реализации интерактора .

</p>
   </article>
</body>
</html>
