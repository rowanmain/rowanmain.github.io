<!DOCTYPE html><html lang="ru"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>book</title></head><body>книг . Архитектура кричит: «Это библиотека» .

А что кричит архитектура вашего приложения? Увидев высокоуровневую 

структуру каталогов и пакетов с исходным кодом, услышите ли вы, как она 

кричит: «Это медицинская система», или «Это система учета», или «Это 

система управления складским хозяйством»? Или вы услышите: «Rails», 

или «Spring/Hibernate», или «ASP»?

Тема архитектуры

Отвлекитесь и прочитайте фундаментальный труд Ивара Якобсона об 

архитектуре программного обеспечения: книгу Object Oriented Software 

Engineering1 . Обратите внимание на подзаголовок книги: A Use Case Driven 

Approach2 . В этой книге Якобсон подчеркивает, что архитектура программ-

ного обеспечения — это структура, поддерживающая варианты использова-

ния системы . В точности как план библиотеки или коттеджа кричит о на-

значении здания, архитектура программного обеспечения должна кричать 

о вариантах использования приложения .

Архитектуры не связаны (и не должны быть связаны) с фреймворками . 

Архитектура не должна определяться фреймворками . Фреймворки — это 

1 Проектирование объектно-ориентированного программного обеспечения . — Примеч. 

пер.

2 Подход на основе вариантов использования . — Примеч. пер.

А что насчет Веб?      199

инструменты, а вовсе не аспекты, определяющие черты архитектуры . Если 

ваша архитектура опирается на фреймворки, она не сможет опираться на 

варианты использования .

Цель архитектуры

Хорошие архитектуры опираются на варианты использования и помогают 

архитекторам описывать структуры, поддерживающие эти варианты ис-

пользования, не связывая себя фреймворками, инструментами и окружени-

ями . Взгляните на план коттеджа еще раз . Одной из первоочередных забот 

архитектора является удобная планировка дома, а не выбор материала для 

стен . Действительно, архитектор прилагает максимум усилий, чтобы дать 

домовладельцу возможность самому выбрать материал (кирпич, камень или 

дерево), потом, когда планы, соответствующие вариантам использования, 

уже будут начерчены .

Хорошая архитектура позволяет отложить решение о выборе фреймворков, 

баз данных, веб-серверов и других инструментов и элементов окружения . 

Фреймворки относятся к возможностям, которые должны оставаться от-

крытыми. Хорошая архитектура позволяет отложить выбор Rails, Spring, 

Hibernate, Tomcat или MySQL на отдаленный срок . Хорошая архитектура 

позволяет с легкостью менять подобные решения . Хорошая архитектура 

подчеркивает варианты использования и отделяет их от второстепенных 

проблем .

А что насчет Веб?

Веб — это архитектура? Зависит ли архитектура системы от того факта, что 

свои услуги она предоставляет через Веб? Конечно нет! Всемирная паутина 

(или Веб) — это механизм доставки, устройство ввода/вывода . И архитек-

тура вашего приложения должна интерпретировать его именно так, а не 

иначе . Факт предоставления услуг через Веб — это деталь, и она не должна 

определять структуру системы . В действительности решение о предостав-

лении услуг через Веб относится к разряду решений, которые должны от-

кладываться . Архитектура системы должна быть максимально нейтральной 

200   Глава 21. Кричащая архитектура

к механизмам доставки услуг . У вас должна иметься возможность реализо-

вать систему в форме консольного приложения, веб-приложения, толстого 

клиента или даже веб-службы без чрезмерного усложнения или изменения 

основной архитектуры .

Фреймворки — это инструменты, 

а не образ жизни

Фреймворки могут быть очень мощными и удобными . Авторы фреймворков 

часто глубоко убеждены в своих творениях . Примеры, которые они пишут, 

рассказывают об использовании их фреймворков с точки зрения истинно 

верующих . Другие авторы, пишущие книги о фреймворках, тоже часто сто-

ят на позициях истинной веры . Они показывают способы использования 

фреймворков, часто с позиции всеобъемлющего, всепроникающего и по-

всеместного применения .

Вы не должны вставать на эту позицию.

Рассматривайте фреймворки с холодком . Смотрите на них скептически . Да, 

они могут помочь, но какой ценой? Спросите себя, как бы вы их исполь-

зовали и как защитились бы от них . Подумайте, как сохранить приоритет 

вариантов использования для архитектуры . Разработайте стратегию, не 

позволяющую фреймворку влиять на архитектуру .

Тестируемые архитектуры

Если архитектура вашей системы основана исключительно на вариантах 

использования и вам удалось удержать фреймворки на расстоянии, у вас 

должна иметься возможность протестировать все эти варианты использо-

вания без привлечения фреймворков . Вы не должны испытывать потреб-

ности в веб-сервере для выполнения тестов . Вы не должны испытывать 

потребности в подключении к базе данных для выполнения тестов . Ваши 

сущности должны быть самыми обычными объектами, не зависящими от 

фреймворков, баз данных или чего-то другого . Ваши объекты вариантов 

использования должны координировать действия сущностей . Наконец, 

должна иметься возможность протестировать их вместе без привлечения 

любых фреймворков .

Заключение      201

Заключение

Ваша архитектура должна рассказывать о системе, а не о фреймворках, ис-

пользованных в системе . Если вы работаете над системой для медицинского 

учреждения, тогда первый же взгляд на репозиторий с исходным кодом 

должен вызывать у новых программистов, подключающихся к проекту, 

мысль: «Да, это медицинская система» . Новые программисты должны иметь 

возможность изучить все возможные варианты использования, даже не зная, 

как будут доставляться услуги системы . Они могут подойти к вам и сказать: 

«Мы видим что-то похожее на модели, но где контроллеры и представле-

ния?»

А вы должны ответить:

«Это такая мелочь, которая нас пока не заботит . Мы решим этот вопрос 

позже» .

22 Чистая архитектура

Чистая архитектура      203

За последние несколько десятилетий мы видели целый ряд идей об органи-
</body></html>