<!DOCTYPE html><html lang="ru"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>book</title></head><body>для админист-

ратора

Контроллеры 

для админист-

ратора

Представ-

ления 

для автора

Презента-

торы 

для автора

Интеракторы 

для автора

Контроллеры 

для автора

Презентаторы 

для 

покупателя

Интеракторы 

для 

покупателя

Контроллеры 

для 

покупателя

Представ-

ление 

каталога

Презентатор 

каталога

Представ-

ления 

для зрителя

Презентаторы 

для зрителя

Интеракторы 

для зрителя

Контроллеры 

для зрителя

Шлюзы для 

поступления 

доходов

Шлюзы 

для данных

База данных 

(Datomic)

Представ-

ления для 

покупателя

Рис. 33.2. Предварительная компонентная архитектура

1 Это мой собственный стиль выделения абстрактных вариантов использования . Я мог 

бы использовать более стандартный UML-стереотип, такой как <<abstract>>, но в дан-

ный момент я не считаю полезным следовать таким стандартам .

286   Глава 33. Практический пример: продажа видео

Двойными линиями, как обычно, изображены архитектурные границы . Как 

видите, это типичное деление на представления, презентаторы, интеракторы 

и контроллеры . Также отметьте, что каждую из этих категорий я разбил на 

подкатегории по соответствующим им действующим лицам .

Каждый компонент на рис . 33 .2 потенциально представляет файл .jar или 

.dll и каждый будет содержать соответствующие представления, презента-

торы, интеракторы и контроллеры .

Обратите внимание на особые компоненты Представление каталога и Пре-

зентатор каталога . Именно так предполагается реализовать абстрактный 

вариант использования Просмотр каталога . Я предполагаю, что такие пред-

ставления и презентаторы будут иметь вид абстрактных классов, которые 

будут наследовать конкретные классы представлений и презентаторов 

в производных компонентах .

Стал бы я действительно разбивать систему на все эти компоненты и органи-

зовывать их в файлы .jar или .dll? И да и нет . Конечно, я мог бы помудрить 

над компиляцией и настроить окружение так, чтобы действительно можно 

было создавать компоненты, развертываемые независимо . Также я мог бы 

оставить за собой право объединить компоненты, чтобы при необходимости 

получить меньшее количество единиц развертывания . Например, компонен-

ты, изображенные на рис . 33 .2, легко можно объединить в пять файлов .jar — 

по одному для представлений, презентаторов, интеракторов, контроллеров 

и утилит соответственно . В этом случае я мог развертывать компоненты, 

которые, скорее всего, будут меняться независимо друг от друга .

Еще один возможный вариант группировки: объединить представления 

и презентаторы в один файл .jar, а интеракторы, контроллеры и утилиты 

поместить в свои, отдельные файлы . Другой, еще более простой вариант 

группировки: создать два файла .jar — один с представлениями и презен-

таторами и другой со всем остальным .

Оставив эти возможности открытыми, позже мы сможем изменить способ 

развертывания системы, исходя из особенностей ее развития .

Управление зависимостями

Поток управления на рис . 33 .2 движется справа налево . Входные данные 

поступают в контроллеры и затем обрабатываются интеракторами . Презен-

таторы форматируют результаты обработки и передают их представлениям 

для отображения .

Заключение      287

Обратите внимание, что не все стрелки направлены справа налево . Факти-

чески большинство из них направлено слева направо . Это объясняется тем, 

что архитектура следует правилу зависимости . Все зависимости пересекают 

архитектурные границы в одном направлении и всегда направлены в сторо-

ну компонентов, содержащих политики более высокого уровня .

Также отметьте, что отношения использования (открытые стрелки) со-

впадают с направлением потока управления, а отношения наследования 

(закрытые стрелки) направлены против потока управления . Это отражает 

использование принципа открытости/закрытости, который требует, чтобы 

зависимости были направлены в правильном направлении и изменения 

в низкоуровневых деталях не затрагивали высокоуровневые политики .
</body></html>