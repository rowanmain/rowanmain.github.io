<!DOCTYPE html><html lang="ru"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>book</title></head><body>ориентированный программист желал иметь объектно-ориентированную базу 

данных в своей системе. Идея была относительно простой и глубоко идеали-

стической. База данных хранила объекты, а не таблицы. База данных должна 

была выглядеть как ОЗУ. Когда производилось обращение к объекту, он просто 

возникал в памяти. Если этот объект ссылался на другой объект, тот другой 

объект тоже появлялся в памяти при первой попытке обратиться к нему. Это 

было похоже на волшебство.

Выбор этой базы данных стал, пожалуй, самой большой нашей ошибкой. 

Мы желали волшебства, а в результате получили большой, медленный, на-

вязчивый, дорогостоящий сторонний фреймворк, который превратил нашу 

жизнь в ад, препятствуя нашему движению вперед почти на всех уровнях.

Выбор базы данных был не единственной нашей ошибкой. Гораздо более 

серьезной ошибкой фактически стало излишнее усердие в отношении к про-

ектированию архитектуры. У нас получилось намного больше уровней, чем 

я описал здесь, и каждый привносил свои накладные расходы на взаимодей-

ствия. Это отрицательно сказалось также на продуктивности команды.

В итоге, после многих человеко-лет работы, тяжелой борьбы и выпуска двух 

слабых версий, весь инструмент был заменен маленьким приложением, напи-

санным небольшой командой из Висконсина.

Так я узнал, что великие архитектуры иногда приводят к великим провалам. 

Архитектура должна быть достаточно гибкой, чтобы подстраиваться под размер 

задачи. Разработка архитектуры для уровня предприятия, когда в действитель-

ности нужен маленький и удобный инструмент для настольного компьютера, — 

это верный рецепт провала.

Регистрационные экзамены 

для архитекторов

В начале 1990-х годов я стал настоящим консультантом. Я ездил по миру и обучал 

людей новым объектно-ориентированным подходам. В своих консультациях я стро-

го ограничивался дизайном и архитектурой объектно-ориентированных систем.

Одним из моих первых клиентов была компания Educational Testing Service 

(ETS). Она имела контракт с Национальным советом регистрационной кол-

легии по архитектуре (National Council of Architects Registry Board, NCARB) 

по проведению регистрационных экзаменов для новых кандидатов в архи-

текторы.

Любой желающий стать зарегистрированным архитектором (проектирующим 

здания) в США или Канаде должен сдать регистрационный экзамен. На этом 

экзамене кандидату предлагается решить несколько архитектурных задач, 

Регистрационные экзамены для архитекторов   345

связанных с проектированием зданий. Кандидату передается ряд требований 

для проектирования общественной библиотеки, ресторана или церкви и затем 

предлагается нарисовать комплект архитектурных схем.

Результаты собираются и сохраняются, пока не соберется комиссия ведущих 

архитекторов для оценки. Создание комиссии — большое, дорогостоящее со-

бытие и вечный источник задержек и недопонимания.

Совет NCARB хотел автоматизировать процесс и организовать сдачу экзаменов 

с использованием компьютера, а оценку поданных решений производить с помо-

щью другого компьютера. Совет NCARB предложил компании ETS разработать 

соответствующее программное обеспечение, а ETS наняла меня для создания 

коман ды разработчиков с целью разработки этого продукта.

Компания ETS разбила проблему на 18 экзаменационных заданий. Для каждого 

требовалось создать приложение с графическим интерфейсом в стиле систем 

автоматизированного проектирования, которое кандидат мог бы использовать 

для оформления своего решения. Анализ и оценку решений должны произво-

дить другие 18 приложений.

Мы с моим партнером Джимом Ньюкирком заметили, что эти 36 приложений 

имеют огромное сходство. Все 18 экзаменационных приложений с графиче-

ским интерфейсом должны реализовать схожие операции и использовать 

схожие механизмы. Другие 18 приложений, оценивающие решения, должны 

использовать один и тот же математический аппарат. Учитывая большое коли-

чество общих элементов, Джим и я решили разработать многократно исполь-

зуемую инфраструктуру, которая должна лечь в основу всех 36 приложений. 

Фактически мы продали эту идею компании ETS, заявив, что на разработку 

первого приложения потребуется много времени, зато все последующие будут 

выпущены в течение нескольких недель.

Прочитав эти строки, многие из вас могли бы выразить крайнее удивление. Но чи-

татели постарше наверняка помнят, как объектно-ориентированный подход обе-

щал «многократное использование». В ту пору мы все были убеждены, что если 

писать хороший, чистый, объектно-ориентированный код на C++, в результате 

получится много-много кода, пригодного для многократного использования.

Итак, мы приступили к разработке первого приложения — самого сложного 

в пакете. Мы назвали его Vignette Grande.

Мы вдвоем работали над Vignette Grande с прицелом на создание инфраструк-

туры многократного использования. Нам понадобился год. К концу этого года 

у нас были 45 000 строк инфраструктурного и 6000 строк прикладного кода. Мы 

принесли этот продукт в ETS, и они заключили с нами контракт на создание 

других 17 приложений в ограниченный срок.

Мы с Джимом наняли еще трех разработчиков и приступили к созданию сле-

дующих нескольких экзаменационных приложений.

346   Приложение. Архитектурная археология

Но что-то пошло не так. Мы обнаружили, что наша инфраструктура оказалась 

почти непригодна для многоразового использования. Она не вписывалась в но-

вые приложения. Имелись шероховатости, мешавшие работе.

Мы были сильно обескуражены, но считали, что знаем, как поступить с этим. 

Мы пришли в ETS и сказали, что задерживаемся — что 45 000-строчную инфра-

структуру требуется переписать или хотя бы скорректировать и что для этого 

потребуется еще много времени.

Я думаю, излишне говорить, что в ETS не очень обрадовались этой новости. 

Тем не менее мы начали все сначала. Мы отложили старую инфраструктуру 

и приступили к созданию сразу четырех новых экзаменационных приложе-

ний. Мы заимствовали некоторые идеи и код из старой инфраструктуры, но 

переделывали их так, чтобы они вписывались во все четыре приложения без 

изменений.

На это ушел еще один год. Мы написали другую инфраструктуру с 45 000 строк 

кода плюс четыре экзаменационных приложения, содержавших от 3000 до 

6000 строк каждое. Разумеется, отношения между приложениями и инфра-

структурой следовали правилу зависимости. Приложения были плагинами 

для инфраструктуры. Все высокоуровневые политики находились в инфра-

структуре. Прикладной код просто «склеивал» разные операции.

Отношения между инфраструктурой и приложениями оценки решений оказались 

намного сложнее. Высокоуровневая политика оценки находилась в приложении. 
</body></html>