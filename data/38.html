<!DOCTYPE html><html lang="ru"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>book</title></head><body>компонентов . Это верно, потому что принцип SDP требует, чтобы зависимо-

сти были направлены в сторону устойчивости, а принцип SAP утверждает, 

что устойчивость подразу мевает абстрактность . То есть зависимости должны 

быть направлены в сторону абстрактности .

Однако принцип DIP сформулирован для классов, и в случае с классами 

нет никаких полутонов . Класс либо абстрактный, либо нет . Принципы SDP 

и SAP действуют в отношении компонентов и допускают ситуацию, когда 

компонент частично абстрактный или частично устойчивый .

Мера абстрактности

Мерой абстрактности компонента служит метрика A . Ее значение определя-

ется простым отношением количества интерфейсов и абстрактных классов 

к общему числу классов в компоненте .

Принцип устойчивости абстракций      137

 

� Nc: число классов в компоненте .

 

� Na: число абстрактных классов и интерфейсов в компоненте .

 

� A: абстрактность . A = Na ÷ Nc .

Значение метрики A изменяется в диапазоне от 0 до 1 . 0 означает полное 

отсутствие абстрактных классов в компоненте, а 1 означает, что компонент 

не содержит ничего, кроме абстрактных классов .

Главная последовательность

Теперь мы можем определить зависимость между устойчивостью (I) 

и абстракт ностью (A) . Для этого нарисуем график со значениями A по 

вертикальной оси и значениями I — по горизонтальной (рис . 14 .12) . Если 

нанести на график «хорошие» компоненты обоих видов, обнаружится, что 

максимально устойчивые и абстрактные находятся слева вверху, в точке 

с координатами (0, 1), а максимально неустойчивые и конкретные — справа 

внизу, в точке (1, 0) .

Рис. 14.12. График I/A

Но не все компоненты попадают в эти две точки, потому что компоненты 

имеют разные степени абстрактности и устойчивости . Например, очень 

часто один абстрактный класс наследует другой абстрактный класс . В ре-

зультате получается абстрактный класс, имеющий зависимость . Поэтому, 

несмотря на абстрактность, он не будет максимально устойчивым . Зависи-

мость уменьшает устойчивость .

138   Глава 14. Сочетаемость компонентов

Так как нельзя потребовать, чтобы все компоненты находились в двух 

точках (0, 1) или (1, 0), мы должны предположить, что на графике A/I 

имеется некоторое множество точек, определяющих оптимальные позиции 

для компонентов . Вывести это множество можно, определив области, где 

компоненты не должны находиться, — иными словами, определив зоны ис-

ключения (рис . 14 .13) .

Зона

бесполезности

Главная последовательность

Зона боли

Рис. 14.13. Зоны исключения

Зона боли

Рассмотрим компонент в точке (0, 0) . Это очень устойчивый и конкретный 

компонент . Такие компоненты нежелательны, потому что слишком жест-

кие . Их нельзя расширить, потому что они неабстрактные, и очень трудно 

изменить из-за большой устойчивости . Поэтому правильно спроектиро-

ванные компоненты обычно не должны находиться рядом с точкой (0, 0) . 

Область вокруг точки (0, 0) — это зона исключения, которую называют 

зоной боли .

Некоторые программные сущности действительно попадают в зону боли . 

Примером может служить схема базы данных . Схемы баз данных печально 

известны своей изменчивостью, до предела конкретны и к ним тянется 

множество зависимостей . Это одна из причин, почему так сложно управ-

лять интерфейсом между объектно-ориентированными приложениями 

и базами данных и почему изменение схемы обычно связано с большой 

болью .

Другой пример программного обеспечения, лежащего поблизости от точ-

ки (0, 0) — конкретная библиотека вспомогательных функций . Хотя такая 

Принцип устойчивости абстракций      139

библиотека имеет метрику I со значением 1, в действительности она может 

быть очень негибкой . Возьмем для примера компонент String . Даже при том, 

что все классы в нем конкретны, он используется настолько широко, что его 

изменение может породить хаос . Поэтому String — негибкий .

Негибкие компоненты в зоне, окружающей точку (0, 0), безопасны, потому 

что, скорее всего, не будут изменяться . По этой причине проблемы вызы-

вают только изменчивые программные компоненты, находящиеся в зоне 

боли . Чем более изменчив компонент, находящийся в зоне боли, тем больше 

«боли» он доставляет . Фактически изменчивость можно рассматривать как 

третью ось графика . С этой точки зрения на рис . 14 .13 изображена самая 

болезненная плоскость, где изменчивость = 1 .

Зона бесполезности

Рассмотрим компонент рядом с точкой (1, 1) . Такие компоненты также не-

желательны, потому что они максимально абстрактны и не имеют входящих 

зависимостей . Они бесполезны . Поэтому данная область так и называется: 

зона бесполезности .

Программные сущности, находящиеся в этой области, являются своего рода 

осколками . Часто это оставшиеся абстрактные классы, которые так и не 

были реализованы . Нам иногда доводится натыкаться на них в системах, 

где они лежат без использования .

Компонент, находящийся глубоко в зоне бесполезности, должен содержать 

значительную долю таких сущностей . Очевидно, что присутствие таких 

бесполезных сущностей нежелательно .

Как не попасть в зоны исключения

Кажется очевидным, что наиболее изменчивые компоненты должны на-

ходиться как можно дальше от зон исключения . Точки, максимально уда-

ленные от обеих зон, лежат на прямой, соединяющей точки (1, 0) и (0, 1) . 

Я называю эту прямую главной последовательностью1 .

Компонент, располагающийся на главной последовательности, не «слишком 

абстрактный» для своей устойчивости и не «слишком неустойчив» для сво-

ей абстрактности . Он не бесполезен и не доставляет особенной боли . От него 

1 Автор просит у читателей снисходительности за такое высокопарное заимствование 

из астрономии .
</body></html>